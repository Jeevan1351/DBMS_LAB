create database airline;
use airline;

create table FLIGHTS(
FLNO INT,
FROM_P VARCHAR(100),
TO_P VARCHAR(100),
DISTANCE INT,
DEPARTS varchar(20),
ARRIVES varchar(20),
PRIMARY KEY(FLNO)
);

CREATE TABLE AIRCRAFT(
 AID INT,
 ANAME VARCHAR(30),
 flightno int,
 foreign key (flightno) references FLIGHTS(FLNO) on delete cascade on update cascade,
 CRUISING_RANGE INT,
 primary key(AID)
 );
 
 CREATE TABLE EMPLOYEES(
 EID INT,
 ENAME VARCHAR(30),
 SALARY INT,
 primary key(EID)
 );
 
 CREATE TABLE CERTIFIED(
 EID INT,
 AID INT,
 FOREIGN KEY(EID)REFERENCES EMPLOYEES(EID)ON DELETE CASCADE ON UPDATE CASCADE,
 FOREIGN KEY(AID)REFERENCES AIRCRAFT(AID)ON DELETE CASCADE ON UPDATE CASCADE
 );
 
INSERT INTO FLIGHTS VALUES(1,"Bangalore","Chennai", 340,'12:30','2:30');
INSERT INTO FLIGHTS VALUES(2,"Bangalore","kochin",320,'18:30','20:30');
INSERT INTO FLIGHTS VALUES(3,"Karnool","Bangalore",300,'09:12','10:12');
INSERT INTO FLIGHTS VALUES(4,"Bangalore","Hyderabad",540,'06:12','07:30');
INSERT INTO FLIGHTS VALUES(5,"Tirchi","Mysore",400,'12:30','13:15');
SELECT *FROM FLIGHTS;

INSERT INTO AIRCRAFT VALUES(1,"Boom",1,3000);
INSERT INTO AIRCRAFT VALUES(2,"Pam",2,3200);
INSERT INTO AIRCRAFT VALUES(3,"Zoom",3,2700);
insert into aircraft values(10, "123",1, 10000);
INSERT INTO AIRCRAFT VALUES(4,"Swish",4,1563);
INSERT INTO AIRCRAFT VALUES(5,"CooCoo",5,1789);
SELECT *FROM AIRCRAFT;

INSERT INTO EMPLOYEES VALUES(001,"Jeevan",25000);
INSERT INTO EMPLOYEES VALUES(002,"Shyam",50000);
INSERT INTO EMPLOYEES VALUES(003,"Kumar",37000);
INSERT INTO EMPLOYEES VALUES(004,"Ronnie",13000);
INSERT INTO EMPLOYEES VALUES(005,"Honey Singh",43000);
INSERT INTO EMPLOYEES VALUES(006,"Dhinchak Pooja",62000);
SELECT *FROM EMPLOYEES;

INSERT INTO CERTIFIED VALUES(001,1);
INSERT INTO CERTIFIED VALUES(001,2);
INSERT INTO CERTIFIED VALUES(003,3);
SELECT *FROM CERTIFIED;


SELECT EID, ENAME FROM EMPLOYEES NATURAL JOIN CERTIFIED HAVING COUNT(CERTIFIED.EID) >= 2;


SELECT E.EID, ENAME FROM EMPLOYEES E, CERTIFIED C WHERE E.EID = C.EID GROUP BY C.EID;
SELECT E.EID, ENAME FROM EMPLOYEES E, CERTIFIED C WHERE E.EID != C.EID GROUP BY C.EID;

DELETE FROM AIRCRAFT WHERE CRUISING_RANGE = 10000;

DELETE FROM EMPLOYEES WHERE SALARY < 20000;

ALTER TABLE EMPLOYEES ADD COLUMN CITY VARCHAR(100);
ALTER TABLE EMPLOYEES ADD CONSTRAINT CHECKING1 CHECK(SALARY > 20000);


CREATE VIEW SALARY(EID, TOTAL_SALARY, AVG_SALARY) AS SELECT E.EID, SUM(E.SALARY), AVG(E.SALARY) FROM EMPLOYEES E, CERTIFIED C WHERE E.EID = C.EID GROUP BY C.EID;
select * from SALARY;